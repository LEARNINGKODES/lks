<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Learning Kodes</title>
  <link rel="stylesheet" href="juego.css" />
  <style>
    #explicacion-texto {
      user-select: none;
    }
    .registro {
      padding:20px;
      text-align:center;
      border-bottom:2px solid #ccc;
    }
    .registro input {
      padding:5px;
      margin:5px;
    }
    .lista-registrados {
      margin-top:10px;
      text-align:center;
    }
    .lista-registrados ul {
      list-style:none;
      padding:0;
    }
    .lista-registrados li {
      margin:3px 0;
    }
    iframe {
      width:100%;
      height:150px;
      border:1px solid #ccc;
      margin-top:10px;
    }
  </style>
</head>
<body>
<


<!-- === BARRA SUPERIOR === -->
<header class="barra-superior" style="display:none;" id="headerJuego">
  <h1><a class="INICIO" href="index.html">LEARNING KODES</a></h1>
  <p>Aprende HTML y CSS paso a paso con nuestra abeja guía</p>
</header>

<!-- === EXPLICACIÓN Y JUEGO === -->
<div id="explicacion" class="explicacion" style="display:none;">
  <img src="./img/Logotipo.png" class="abeja" alt="abeja guia" />
  <p id="explicacion-texto"></p>
</div>

<div id="pantalla-css" style="display:none; text-align:center; padding:20px;">
  <h2>¡Felicidades!</h2>
  <p>Has completado los 10 niveles de <b>HTML</b>.  
  Ahora ya sabes lo básico de cómo crear la estructura de una página web con etiquetas.</p>
  <p>Pero una página no solo necesita estructura, también necesita <b>estilo</b>: colores, tamaños, formas, márgenes...  
  Para eso existe <b>CSS</b>, que trabaja junto al HTML para darle diseño.</p>
  <button onclick="empezarCSS()">Empezar CSS</button>
</div>

<div class="zona-juego" style="display:none;">
  <div class="escenario" id="escenario">
    <div><h1>Hola</h1></div>
    <div><p>Esto es un párrafo</p></div>
    <div><br>NIKOLL Y ANGIE MIS DULCE PRINCESAS</div>
    <div><b>LEARNINGKODES</b></div>
    <div><h3>©JLMN & FSDM STUDIOS</h3></div>
  </div>

  <div class="panel-control">
    <label for="htmlInput">Escribe el <b>HTML</b>:</label>
    <textarea id="htmlInput" rows="4" placeholder="Ej: &lt;h1&gt;Hola&lt;/h1&gt;" oninput="actualizarVista()"></textarea>
  
    <div id="panelCSS" style="display:none; margin-top:10px;">
      <label for="cssInput">Escribe el <b>CSS</b>:</label>
      <textarea id="cssInput" rows="4" placeholder="Ej: .caja1 { width:100px; height:100px; background:black; }" oninput="actualizarVista()"></textarea>
    </div>
  
    <!-- Agrupamos botones en un mismo contenedor -->
    <div class="botones-acciones">
      <button onclick="verificarCodigo()">Verificar</button>
  
      <div class="controles" style="display:none;" id="controlesJuego">
        <button onclick="nivelAnterior()">Anterior</button>
        <button onclick="siguienteNivel()" id="btnSiguiente" style="display:none;">Siguiente</button>
      </div>
    </div>
  
    <p id="mensaje"></p>
  
    <h3>Vista previa:</h3>
    <iframe id="vista-previa"></iframe>
  </div>
  

<!-- === FINAL === -->
<div class="controles" style="display:none;" id="fin-juego">
  <p>¡Felicidades! Has terminado todos los niveles</p>
  <div class="lista-registrados">
    <h3>Personas registradas:</h3>
    <ul id="listaRegistradosFinal"></ul>
  </div>
  <button onclick="location.href='index.html'">Volver al inicio</button>
</div>

<script>
 document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    document.title = "Regresa :'(";
  } else {
    document.title = "Gracias por volver ^⁠_⁠^";
  }
 });
let nivelActual = 0;

// ===== REGISTRO =====
  


// ===== FUNCIONES DE JUEGO =====
function cargarNivel() {
  const nivel = niveles[nivelActual];
  document.getElementById("explicacion-texto").innerText = nivel.instruccion + "\n" + nivel.explicacion;

  // Reset inputs
  document.getElementById("htmlInput").value = "";
  document.getElementById("cssInput").value = "";

  // Mostrar/ocultar panel CSS
  if (nivel.tipo === "css") {
    document.getElementById("panelCSS").style.display = "block";
  } else {
    document.getElementById("panelCSS").style.display = "none";
  }

  // Ocultar botón siguiente hasta que valide
  document.getElementById("btnSiguiente").style.display = "none";
  document.getElementById("mensaje").textContent = "";
  actualizarVista();
}

function verificarCodigo() {
  const html = document.getElementById("htmlInput").value;
  const css = document.getElementById("cssInput").value;
  const nivel = niveles[nivelActual];
  let correcto = false;

  if (nivel.tipo === "html") {
    correcto = nivel.validar(html, css);
  } else {
    const tagRegex = new RegExp(`<${nivel.htmlRequerido.tag}\\s+class=["']${nivel.htmlRequerido.clase}["'].*>.*</${nivel.htmlRequerido.tag}>`, "i");
    correcto = tagRegex.test(html);
    if (correcto) {
      correcto = nivel.propsCSS.every(r => r.test(css));
    }
  }

  const mensaje = document.getElementById("mensaje");

if (correcto) {
  mensaje.innerText = "¡Muy bien!";
  mensaje.className = "mensaje-correcto";
  document.getElementById("btnSiguiente").style.display = "inline-block";
} else {
  mensaje.innerText = "Intenta otra vez.";
  mensaje.className = "mensaje-error";
  document.getElementById("btnSiguiente").style.display = "none";
}



  actualizarVista();
}

function actualizarVista() {
  const html = document.getElementById("htmlInput").value;
  const css = document.getElementById("cssInput").value;
  const iframe = document.getElementById("vista-previa");
  const doc = iframe.contentDocument || iframe.contentWindow.document;
  doc.open();
  doc.write(`
    <html>
      <head><style>${css}</style></head>
      <body>${html}</body>
    </html>
  `);
  doc.close();
}

function nivelAnterior() {
  if (nivelActual > 0) {
    nivelActual--;
    cargarNivel();
  }
}

function siguienteNivel() {
  if (nivelActual === 14) { 
    document.querySelector('.zona-juego').style.display = 'none';
    document.getElementById("explicacion").style.display = 'none';
    document.getElementById("pantalla-css").style.display = 'block';
  } else if (nivelActual < niveles.length - 1) {
    nivelActual++;
    cargarNivel();
  } else {
    document.querySelector('.zona-juego').style.display = 'none';
    document.getElementById("fin-juego").style.display = 'block';
    document.getElementById("explicacion").style.display = 'none';
    mostrarRegistradosFinal();
  }
}

function empezarCSS() {
  document.getElementById("pantalla-css").style.display = "none";
  document.querySelector('.zona-juego').style.display = 'flex';
  document.getElementById("explicacion").style.display = 'flex';
  nivelActual = 15;
  cargarNivel();
}
const niveles = [
  { tipo:'html',
    instruccion:"Nivel 1: Crea un título con <h1>",
    explicacion:"El encabezado principal se hace con <h1>. Ejemplo: <h1>Hola Mundo</h1>.",
    validar: (h) => /^<h1>[\s\S]*<\/h1>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 2: Escribe un párrafo con <p>",
    explicacion:"El párrafo se define con <p>. Ejemplo: <p>Este es un texto</p>.",
    validar: (h) => /^<p>[\s\S]*<\/p>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 3: Inserta un salto de línea <br>",
    explicacion:"El salto de línea se hace con <br>, no necesita etiqueta de cierre.",
    validar: (h) => /<br\s*\/?>/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 4: Texto en negrita con <b>",
    explicacion:"La etiqueta <b> sirve para poner en negrita. Ejemplo: <b>Texto</b>.",
    validar: (h) => /^<b>[\s\S]*<\/b>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 5: Texto en cursiva con <i>",
    explicacion:"La etiqueta <i> sirve para cursiva. Ejemplo: <i>Texto</i>.",
    validar: (h) => /^<i>[\s\S]*<\/i>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 6: Subtítulo con <h2>",
    explicacion:"Es un subtítulo debajo de <h1>. Ejemplo: <h2>Subtítulo</h2>.",
    validar: (h) => /^<h2>[\s\S]*<\/h2>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 7: Encabezado más pequeño <h3>",
    explicacion:"Los encabezados se hacen con <h1> a <h6>. Ejemplo: <h3>Título</h3>.",
    validar: (h) => /^<h3>[\s\S]*<\/h3>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 8: Lista ordenada <ol>",
    explicacion:"Crea una lista numerada. Ejemplo: <ol><li>Uno</li><li>Dos</li></ol>.",
    validar: (h) => /^<ol>[\s\S]*<\/ol>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 9: Lista desordenada <ul>",
    explicacion:"Crea una lista con viñetas. Ejemplo: <ul><li>A</li><li>B</li></ul>.",
    validar: (h) => /^<ul>[\s\S]*<\/ul>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 10: Imagen con <img>",
    explicacion:"La imagen se inserta con <img src='url' alt='texto'>.",
    validar: (h) => /<img[^>]+src=["'][^"']+["'][^>]*>/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 11: Enlace con <a>",
    explicacion:"Los enlaces se crean con <a href='url'>Texto</a>.",
    validar: (h) => /<a[^>]+href=["'][^"']+["'][^>]*>[\s\S]*<\/a>/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 12: Línea horizontal <hr>",
    explicacion:"La etiqueta <hr> dibuja una línea divisoria.",
    validar: (h) => /<hr\s*\/?>/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 13: Crear un div contenedor <div>",
    explicacion:"El <div> agrupa elementos. Ejemplo: <div>Contenido</div>.",
    validar: (h) => /^<div>[\s\S]*<\/div>$/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 14: Agregar un atributo id",
    explicacion:"Ejemplo: <p id='intro'>Hola</p>. Usa id='...' dentro de la etiqueta.",
    validar: (h) => /<\w+\s+id=["'][^"']+["'][^>]*>[\s\S]*<\/\w+>/i.test(h.trim())
  },
  { tipo:'html',
    instruccion:"Nivel 15: Agregar una clase",
    explicacion:"Ejemplo: <p class='rojo'>Texto</p>. Usa class='...'.",
    validar: (h) => /<\w+\s+class=["'][^"']+["'][^>]*>[\s\S]*<\/\w+>/i.test(h.trim())
  },

  // --- CSS (15 niveles) ---
  { tipo:'css',
    instruccion:"Nivel 16: Cuadrado negro 100x100",
    explicacion:"HTML: <div class='caja'></div> | CSS: .caja{width:100px;height:100px;background:black;}",
    htmlRequerido:{tag:'div', clase:'caja'},
    propsCSS:[/width\s*:\s*100px/i,/height\s*:\s*100px/i,/(background|background-color)\s*:\s*black/i]
  },
  { tipo:'css',
    instruccion:"Nivel 17: Círculo azul",
    explicacion:"HTML: <div class='circulo'></div> | CSS: .circulo{width:100px;height:100px;background:blue;border-radius:50%;}",
    htmlRequerido:{tag:'div', clase:'circulo'},
    propsCSS:[/width\s*:\s*100px/i,/height\s*:\s*100px/i,/background\s*:\s*blue/i,/border-radius\s*:\s*50%/i]
  },
  { tipo:'css',
    instruccion:"Nivel 18: Rectángulo rojo 200x100",
    explicacion:"HTML: <div class='rect'></div> | CSS: .rect{width:200px;height:100px;background:red;}",
    htmlRequerido:{tag:'div', clase:'rect'},
    propsCSS:[/width\s*:\s*200px/i,/height\s*:\s*100px/i,/background\s*:\s*red/i]
  },
  { tipo:'css',
    instruccion:"Nivel 19: Texto verde",
    explicacion:"HTML: <p class='verde'>Hola</p> | CSS: .verde{color:green;}",
    htmlRequerido:{tag:'p', clase:'verde'},
    propsCSS:[/color\s*:\s*green/i]
  },
  { tipo:'css',
    instruccion:"Nivel 20: Fondo amarillo",
    explicacion:"HTML: <div class='amarillo'>Texto</div> | CSS: .amarillo{background-color:yellow;}",
    htmlRequerido:{tag:'div', clase:'amarillo'},
    propsCSS:[/background(-color)?\s*:\s*yellow/i]
  },
  { tipo:'css',
    instruccion:"Nivel 21: Texto grande",
    explicacion:"HTML: <p class='grande'>Texto</p> | CSS: .grande{font-size:30px;}",
    htmlRequerido:{tag:'p', clase:'grande'},
    propsCSS:[/font-size\s*:\s*30px/i]
  },
  { tipo:'css',
    instruccion:"Nivel 22: Texto en cursiva",
    explicacion:"HTML: <p class='cursiva'>Texto</p> | CSS: .cursiva{font-style:italic;}",
    htmlRequerido:{tag:'p', clase:'cursiva'},
    propsCSS:[/font-style\s*:\s*italic/i]
  },
  { tipo:'css',
    instruccion:"Nivel 23: Texto en negrita",
    explicacion:"HTML: <p class='negrita'>Texto</p> | CSS: .negrita{font-weight:bold;}",
    htmlRequerido:{tag:'p', clase:'negrita'},
    propsCSS:[/font-weight\s*:\s*bold/i]
  },
  { tipo:'css',
    instruccion:"Nivel 24: Borde negro de 5px",
    explicacion:"HTML: <div class='marco'>Hola</div> | CSS: .marco{border:5px solid black;}",
    htmlRequerido:{tag:'div', clase:'marco'},
    propsCSS:[/border\s*:\s*5px\s+solid\s+black/i]
  },
  { tipo:'css',
    instruccion:"Nivel 25: Márgenes y relleno",
    explicacion:"HTML: <div class='espaciado'>Texto</div> | CSS: .espaciado{margin:20px;padding:10px;}",
    htmlRequerido:{tag:'div', clase:'espaciado'},
    propsCSS:[/margin\s*:\s*20px/i,/padding\s*:\s*10px/i]
  },
  { tipo:'css',
    instruccion:"Nivel 26: Centrar texto",
    explicacion:"HTML: <p class='centrado'>Hola</p> | CSS: .centrado{text-align:center;}",
    htmlRequerido:{tag:'p', clase:'centrado'},
    propsCSS:[/text-align\s*:\s*center/i]
  },
  { tipo:'css',
    instruccion:"Nivel 27: Texto subrayado",
    explicacion:"HTML: <p class='subrayado'>Hola</p> | CSS: .subrayado{text-decoration:underline;}",
    htmlRequerido:{tag:'p', clase:'subrayado'},
    propsCSS:[/text-decoration\s*:\s*underline/i]
  },
  { tipo:'css',
    instruccion:"Nivel 28: Fondo con imagen",
    explicacion:"HTML: <div class='fondo'></div> | CSS: .fondo{background-image:url('img.png');}",
    htmlRequerido:{tag:'div', clase:'fondo'},
    propsCSS:[/background-image\s*:\s*url/i]
  },
  { tipo:'css',
    instruccion:"Nivel 29: Esquinas redondeadas",
    explicacion:"HTML: <div class='redondeado'></div> | CSS: .redondeado{border-radius:15px;}",
    htmlRequerido:{tag:'div', clase:'redondeado'},
    propsCSS:[/border-radius\s*:\s*15px/i]
  },
  { tipo:'css',
    instruccion:"Nivel 30: Sombra en el texto",
    explicacion:"HTML: <p class='sombra'>Hola</p> | CSS: .sombra{text-shadow:2px 2px 4px gray;}",
    htmlRequerido:{tag:'p', clase:'sombra'},
    propsCSS:[/text-shadow\s*:\s*2px\s+2px\s+4px\s+gray/i]
  }
];


</script>

</body>
</html>
